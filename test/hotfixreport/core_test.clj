(ns hotfixreport.core-test
  (:require [clojure.test :refer :all]
            [hotfixreport.core :refer :all]))

(def tests
   [["4179" "100" "vulnerable.domain.local" "hostdata" "6.1.7601|Microsoft Windows 7 Professional |KB3161664,KB3161949,KB3161958,KB3162835,KB3163245,KB3164033,KB3164035,KB3167679,KB3168965,KB3170106,KB3170455,KB3170735,KB3172605,KB3175024,KB3175443,KB3177186,KB3177467,KB3177723,KB3177725,KB3178034,KB3179573,KB3181988,KB3182203,KB3184122,KB3184143,KB3185319,KB3185911,KB3188730,KB3188740,KB3192321,KB3192391,KB3197867,KB3205394,KB3210131,KB3212642,KB4012212,KB4014504,KB4014573,KB4014579,KB4014596,KB4015193,KB4015546,KB4018271,KB4019263,KB4019990,KB4020322,KB4021558,KB4022722,KB4025252,KB4025337,KB4034679,KB4034733,KB4036586,KB4038779,KB4040966,KB4040980,KB976902,KB982018,KB4038777" "2017-10-23 09:39:57"] ["4180" "100" "invulnerable.otherdomain.local" "hostdata" "10.0.15063|Microsoft Windows 10 Pro|KB4022405,KB4034662,KB4035543,KB4038806,KB4034674,KB4038788,KB4041676" "2017-10-23 09:45:34"]])

(def clean
  {:host "vulnerable", :domain "domain.local"} )

(deftest a-test
  (testing "FIXME, I fail."
    (is (= [clean] (parsereport tests)))))
